<!doctype html>
<html>

<head>
    <title>2-hours</title>
    <link rel="stylesheet" href="https://snlx.net/new.css">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
</head>

<body>
    <nav>
        <h2>Linked Notes</h2>
        <ul>
            <li class="back"><a href="/setting-up-api">setting-up-api</a></li>
            <li class="back"><a href="/cert-typ">cert-typ</a></li>
            <li class="current"><a href="/2-hours">2-hours</a></li>
            <li class="forward"><a href="/setting-up-api">setting-up-api</a></li>
        </ul><a class="source" href="https://github.com/snlxnet/snlx.net"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github-icon lucide-github">
                <path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path>
                <path d="M9 18c-4.51 2-5-2-7-2"></path>
            </svg>Source&nbsp;code</a>
    </nav>
    <main>
        <div class="metadata">
            <div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-feather-icon lucide-feather">
                    <path d="M12.67 19a2 2 0 0 0 1.416-.588l6.154-6.172a6 6 0 0 0-8.49-8.49L5.586 9.914A2 2 0 0 0 5 11.328V18a1 1 0 0 0 1 1z"></path>
                    <path d="M16 8 2 22"></path>
                    <path d="M17.5 15H9"></path>
                </svg>created 72d ago</div>
            <div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-cw-icon lucide-refresh-cw">
                    <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
                    <path d="M21 3v5h-5"></path>
                    <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
                    <path d="M8 16H3v5"></path>
                </svg>updated 16d ago</div>
            <div class="tag">#project</div>
            <div class="tag">#archive</div>
        </div>
        <pre class="frontmatter language-yaml" style="display: none;"><code class="language-yaml is-loaded"><span class="token key atrule">tags</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> project
  <span class="token punctuation">-</span> archive
<span class="token key atrule">created</span><span class="token punctuation">:</span> <span class="token datetime number">2025-11-26</span>
<span class="token key atrule">updated</span><span class="token punctuation">:</span> <span class="token datetime number">2026-01-21T23:00:32+03:00</span>
<span class="token key atrule">post</span><span class="token punctuation">:</span> <span class="token string">"[[snlx.net]]"</span>
<span class="token key atrule">layout</span><span class="token punctuation">:</span> base.njk
<span class="token key atrule">state</span><span class="token punctuation">:</span> done</code></pre>
        <h1 data-heading="2 hours" dir="auto">2 hours</h1>
        <p dir="auto">It's 2025-11-26T23:08. Cert needs to be fully functioning on 2025-11-27T09:00. I wake up at seven. <em>two hours</em>. Until release.</p>
        <h2 data-heading="What needs to work" dir="auto">What needs to work</h2>
        <ol>
            <li dir="auto">generating certs from a horizontal A4 template, check</li>
            <li dir="auto">importing the names &amp; emails from a CSV</li>
            <li dir="auto">sending the generated certs via email</li>
        </ol>
        <h2 data-heading="Changing the direction a bit" dir="auto">Changing the direction a bit</h2>
        <p dir="auto">I was going to make an API endpoint that would ask plunk to send the email, see <a data-href="setting-up-api" href="/" class="internal-link">setting-up-api</a> for more details, but</p>
        <ol>
            <li dir="auto">security is a problem (I don't want anyone sending random files from <em>my</em> server)</li>
            <li dir="auto">the gleam library for plunk doesn't have attachments, and</li>
            <li dir="auto">I have 2 hours</li>
        </ol>
        <p dir="auto">So the idea is to make the user create a plunk account and enter the API key, then the client app can send the emails directly.</p>
        <h2 data-heading="Log: CSV" dir="auto">Log: CSV</h2>
        <p dir="auto">I'll hard-code the email and name columns for now. The only thing needed with that simplification is to read the file as a string, split it into lines, split each line by comas and get 3 elements from that.</p>
        <ol>
            <li dir="auto">To read a CSV into a string, I use <code>new FileReader()</code>, then call <code>readAsText(file, "windows-1251")</code> in it. Auto-detecting the encoding would be nice, but the time is running out.</li>
            <li dir="auto">This file is separated by semicolons, not comas</li>
            <li dir="auto">Not all participants have an email or even a name!</li>
            <li dir="auto">Displaying an alert if a participant is broken and then moving on</li>
            <li dir="auto">I now have 1.5 hours left</li>
        </ol>
        <h2 data-heading="Log: Email" dir="auto">Log: Email</h2>
        <ol>
            <li dir="auto">Plunk has a nice example for how to send them a request <a data-tooltip-position="top" aria-label="https://docs.useplunk.com/guides/send-a-transactional-email-with-attachments" class="external-link" href="https://docs.useplunk.com/guides/send-a-transactional-email-with-attachments">here</a></li>
            <li dir="auto">I now have 1 hour left</li>
            <li dir="auto">The request to plunk is stuck in the "pending" status</li>
            <li dir="auto">It does not work on Rostelecom, weird, I'll set up my own Plunk instance later to fix this</li>
            <li dir="auto">But it does work in genreal!</li>
        </ol>
        <p dir="auto">I've sent myself a dev cert, it worked! 0.5 Hour left!</p>
    </main>
    <script src="https://snlx.net/mobile.js"></script>
    <!-- TODO router.js -->
    <!-- TODO include typ.js everywhere so it's downloaded in the bg & cached -->
</body>

</html>